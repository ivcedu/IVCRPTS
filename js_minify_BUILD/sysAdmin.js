
var m_table;var admin_id="";window.onload=function(){if(sessionStorage.key(0)!==null){getLoginInfo();isLoginAdmin();getAdminList()}else{window.open("login.html","_self")}};$(document).ready(function(){Spark.init();$("#nav_logout").click(function(){sessionStorage.clear();window.open("login.html","_self");return false});$("#btn_new_admin").click(function(){admin_id="";clearModalSection();$("#mod_admin_header").html("New Administrator Setting");$("#mod_admin_active").iCheck("check");$("#mod_admin_setting").modal("show");return false});$("#tbl_admin_list").on("click",'a[id^="admin_id_"]',function(){admin_id=$(this).attr("id").replace("admin_id_","");var a=new Array();a=db_getAdminByID(admin_id);clearModalSection();$("#mod_admin_header").html("Edit Administrator Setting");if(a[0]["Active"]==="1"){$("#mod_admin_active").iCheck("check")}else{$("#mod_admin_active").iCheck("unchecke")}$("#mod_admin_mame").val(a[0]["AdminName"]);$("#mod_admin_email").val(a[0]["AdminEmail"]);$("#mod_admin_setting").modal("show");return false});$("#mod_btn_admin_save").click(function(){var c=($("#mod_admin_active").is(":checked")?true:false);var d=$.trim($("#mod_admin_mame").val());var b=$.trim($("#mod_admin_email").val());if(admin_id===""){if(!adminValidation()){return false}else{if(db_insertAdmin(c,d,b)===""){$("#mod_admin_setting").modal("hide");var a="DB system error INSERT ADMIN";return dbSystemErrorHandling(a)}}}else{if(!db_updateAdminByID(admin_id,c,d,b)){$("#mod_admin_setting").modal("hide");var a="DB system error UPDATE ADMIN - AdminID: "+admin_id;return dbSystemErrorHandling(a)}}getAdminList();$("#mod_admin_setting").modal("hide");return false});m_table=$("#tbl_admin_list").DataTable({paging:false,bInfo:false,searching:false,columnDefs:[{className:"dt-center",orderable:false,targets:3}]});$("input").iCheck({checkboxClass:"icheckbox_square-green",radioClass:"iradio_square-green",increaseArea:"20%"})});function getLoginInfo(){var a=sessionStorage.getItem("ss_rpts_loginName");$("#login_user").html(a+' <span class="caret"></span>');$("#pg_title").html("Administrator");$("#pg_sub_title").html("Administrator setting")}function adminValidation(){if($.trim($("#mod_admin_mame").val())===""){swal({title:"Error",text:"Administrator name is a required field",type:"error"});return false}else{if($.trim($("#mod_admin_email").val())===""){swal({title:"Error",text:"Administrator email is a required field",type:"error"});return false}else{var a=new Array();a=db_getAdminByEmail($.trim($("#mod_admin_email").val()));if(a.length===1){swal({title:"Error",text:"Administrator "+$("#mod_admin_email").val()+" already exist",type:"error"});return false}else{return true}}}}function isLoginAdmin(){var a=new Array();a=db_getAdminByEmail(sessionStorage.getItem("ss_rpts_loginEmail"));if(a.length===1){$(".menu-system-setting").attr("style","display: block !important")}}function clearModalSection(){$("#mod_admin_header").html("");$("#mod_admin_active").iCheck("uncheck");$("#mod_admin_mame").val("");$("#mod_admin_email").val("")}function getAdminList(){var a=new Array();a=db_getAdminListDataTable();m_table.clear();m_table.rows.add(a).draw()};